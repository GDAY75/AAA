<div class="gallery-show" data-controller="lightbox" data-sidebar-target="galleries">
  <h1 class="gal-title"><%= @gallery.title %></h1>
  <% if @gallery.category.present? %>
    <p class="gal-subtitle">Catégorie : <%= @gallery.category %></p>
  <% end %>

  <div class="photos-grid">
    <% @photos.each_with_index do |photo, idx| %>
      <%= link_to "#",
          class: "photo-tile",
          data: {
            action: "click->lightbox#open",
            lightbox_target: "thumb",
            index: idx,
            image_url: asset_path(photo.image),
            caption: (photo.caption.presence || @gallery.title)
          } do %>
        <%= image_tag photo.image, alt: (photo.caption.presence || @gallery.title) %>
      <% end %>
    <% end %>
  </div>

  <!-- Lightbox unique, pilotée par Stimulus -->
  <div class="lightbox" data-lightbox-target="modal" aria-hidden="true">
    <a href="#" class="lightbox-close" data-action="click->lightbox#close" aria-label="Fermer">×</a>

    <!-- Boutons navigation -->
    <button class="lightbox-prev" type="button" data-action="click->lightbox#prev" aria-label="Précédente">‹</button>
    <button class="lightbox-next" type="button" data-action="click->lightbox#next" aria-label="Suivante">›</button>

    <div class="lightbox-content">
      <img data-lightbox-target="image" alt="">
      <div class="lightbox-caption" data-lightbox-target="caption"></div>
    </div>
  </div>
</div>

