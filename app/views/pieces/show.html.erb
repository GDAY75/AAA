<div class="piece-show" data-sidebar-target="pieces">

  <%# --- Bannière : on utilise l'affiche v2 nommée "<TITRE> 2.JPG" --- %>
  <% banner_name = @piece.title.parameterize.underscore + "_2.jpg" %>
  <div class="piece-banner" style="background-image: url('<%= asset_path(banner_name) %>')">
    <h1 class="piece-banner__title"><%= @piece.title %></h1>
  </div>



  <div class="piece-content">
    <% if @piece.respond_to?(:description) && @piece.description.present? %>
      <div class="piece-desc">
        <%= simple_format(@piece.description) %>
      </div>
    <% end %>

    <%# Auteur %>
    <% author = @piece.try(:author) || @piece.try(:auteur) %>
    <% if author.present? %>
      <p class="piece-author"><span>Auteur : </span>&nbsp;<%= author %></p>
    <% end %>
    <p class="piece-author">
      <span>Mise en scène : </span>&nbsp;
      <%= @piece.member.first_name %>&nbsp;<%= @piece.member.last_name.titleize %>

      <span class="star-photo">
        <%= image_tag @piece.title.parameterize.underscore + "_3.jpg", alt: "Mise en scène", class: "star-img" %>
      </span>
    </p>

    <p class="piece-author">
      <span>Comédiens : </span>
      <ul>
        <% @members.each do |member| %>
          <div class="piece-comedien">
            <p><%= member.first_name %> <%= member.last_name.titleize %></p>
            <% roles_count = member.castings.where(piece: @piece).count %>
            <% if roles_count > 1 %>
              <p>dans les rôles de :</p>
            <% else %>
              <p>dans le rôle de :</p>
            <% end %>
            <div class="member-roles">
              <% member.castings.where(piece: @piece).each do |casting| %>
                <div class="member-role">
                  <% if casting.photo.present? %>
                    <div class="casting-photo-oval">
                      <%= image_tag casting.photo, alt: casting.role, class: "oval-img" %>
                    </div>
                  <% end %>
                  <div class="role-name"><%= casting.role %></div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </ul>
    </p>

  </div>
</div>
